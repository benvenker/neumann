{"id":"nm-1","title":"Implement Code Review Changes","description":"Implement all recommendations from the GPT-5 Pro code review to align the codebase with a pages-first philosophy and fix quality issues. This includes changing defaults from \"both pages and tiles\" to \"pages only\", fixing resource leaks with context managers, improving grid tiler edge coverage, tightening CSS styling, updating tests, and lowering Python version requirement to 3.10 for better AI package compatibility.\n\nKey Changes:\n- Make pages-only the default (emit=pages, manifest=none)\n- Fix resource leaks in PDF and image handling\n- Improve grid tiler to guarantee edge coverage\n- Tighten line-number gutter CSS styling\n- Update all documentation to reflect new defaults\n- Add comprehensive tests for default behavior\n- Lower Python requirement from 3.13 to 3.10","status":"open","priority":2,"issue_type":"epic","assignee":"ProductThor","created_at":"2025-10-29T20:39:25.299684-05:00","updated_at":"2025-10-29T20:39:25.299684-05:00"}
{"id":"nm-10","title":"Fix Grid Tiler Edge Coverage","description":"Replace the current grid tiler implementation to guarantee complete edge coverage. The current implementation risks missing content at the right and bottom edges of images. The new implementation must generate coordinate lists that ensure the final tile covers the rightmost and bottommost edges, with proper clamping to prevent out-of-bounds access.\n\nImplementation Details:\n- Replace `tile_grid()` function (lines 266-281) with improved version\n- Generate x/y coordinate lists ensuring right/bottom edges are covered\n- Handle edge case where last tile would extend beyond image bounds\n- Use `min()` to clamp crops and prevent out-of-bounds access\n- Ensure all image content is included in tiles, even near edges","status":"in_progress","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T21:10:46.961075-05:00","updated_at":"2025-10-29T21:10:46.961075-05:00"}
{"id":"nm-2","title":"Change Defaults to Pages-Only","description":"Update RenderConfig class and CLI argument defaults to emit pages only (instead of both pages and tiles) and set manifest to none by default. This aligns with the pages-first philosophy from the code review. Update the header docstring to accurately reflect the new default behavior.\n\nImplementation Details:\n- Update `RenderConfig.emit` default: change from `\"both\"` to `\"pages\"` (line 73 in render_to_webp.py)\n- Update `RenderConfig.manifest` default: change from `\"jsonl\"` to `\"none\"` (line 74)\n- Update CLI `--emit` default: change from `\"both\"` to `\"pages\"` (line 447)\n- Update CLI `--manifest` default: change from `\"jsonl\"` to `\"none\"` (line 448)\n- Update header docstring (lines 3-11) to reflect pages-only default","status":"closed","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:07.938719-05:00","updated_at":"2025-10-29T20:44:50.924053-05:00","closed_at":"2025-10-29T20:44:50.924053-05:00","dependencies":[{"issue_id":"nm-2","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:51.380248-05:00","created_by":"daemon"}]}
{"id":"nm-3","title":"Fix Resource Leaks with Context Managers","description":"Replace manual resource management (open/close) with Python context managers to prevent resource leaks. This ensures proper cleanup of PDF documents and image files even if errors occur during processing.\n\nImplementation Details:\n- In `pdf_to_webp_pages()` (lines 246-263): Replace `doc = fitz.open(...)` and `doc.close()` with `with fitz.open(...) as doc:`\n- In `tile_grid()` (lines 266-281): Wrap `Image.open(webp_path)` with context manager: `with Image.open(...) as base:`\n- In `tile_bands()` (lines 284-303): Wrap `Image.open(webp_path)` with context manager: `with Image.open(...) as base:`","status":"closed","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:11.385453-05:00","updated_at":"2025-10-29T21:07:19.034156-05:00","closed_at":"2025-10-29T21:07:19.034156-05:00","dependencies":[{"issue_id":"nm-3","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:51.572256-05:00","created_by":"daemon"}]}
{"id":"nm-4","title":"Fix Grid Tiler Edge Coverage","description":"Replace the current grid tiler implementation to guarantee complete edge coverage. The current implementation risks missing content at the right and bottom edges of images. The new implementation must generate coordinate lists that ensure the final tile covers the rightmost and bottommost edges, with proper clamping to prevent out-of-bounds access.\n\nImplementation Details:\n- Replace `tile_grid()` function (lines 266-281) with improved version\n- Generate x/y coordinate lists ensuring right/bottom edges are covered\n- Handle edge case where last tile would extend beyond image bounds\n- Use `min()` to clamp crops and prevent out-of-bounds access\n- Ensure all image content is included in tiles, even near edges","status":"closed","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:14.290987-05:00","updated_at":"2025-10-29T21:10:46.602489-05:00","closed_at":"2025-10-29T21:10:46.602489-05:00","dependencies":[{"issue_id":"nm-4","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:51.696248-05:00","created_by":"daemon"}]}
{"id":"nm-5","title":"Fix Page Path Metadata","description":"When emitting only tiles (not pages), the `page_path` field in the manifest should be set to `None` since the page images are deleted. Currently, it references a deleted file. This ensures manifest records are accurate and don't reference non-existent files.\n\nImplementation Details:\n- In `render_file()`, modify the tile manifest record creation (around line 372)\n- Set `\"page_path\": str(wp) if include_page_images else None`\n- This ensures `page_path` is only populated when pages are actually emitted","status":"closed","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:16.613269-05:00","updated_at":"2025-10-29T21:11:20.331945-05:00","closed_at":"2025-10-29T21:11:20.331945-05:00","dependencies":[{"issue_id":"nm-5","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:51.829417-05:00","created_by":"daemon"},{"issue_id":"nm-5","depends_on_id":"nm-2","type":"blocks","created_at":"2025-10-29T20:41:01.209443-05:00","created_by":"daemon"}]}
{"id":"nm-6","title":"Tighten Line-Number Gutter Styling","description":"Make the table-style line number gutter more compact by reducing width, padding, removing the border, and adjusting color. This minimizes wasted horizontal space while keeping line numbers readable. The inline line numbers remain the default (no change needed there).\n\nImplementation Details:\n- Update CSS for table-style line numbers (lines 190-198 in render_to_webp.py):\n  - Reduce `td.linenos` width: `2.6em` → `2.0em`\n  - Reduce padding: `0 6px 0 4px` → `0 4px 0 2px`\n  - Remove `border-right: 1px solid #eee`\n  - Update `td.code` padding: `8px` → `6px`\n  - Update color: `#9a9a9a` → `#a7a7a7`","status":"open","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:20.604953-05:00","updated_at":"2025-10-29T20:40:20.604953-05:00","dependencies":[{"issue_id":"nm-6","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:51.967747-05:00","created_by":"daemon"}]}
{"id":"nm-7","title":"Update Tests","description":"Fix a brittle test assertion that depends on exact quote style, and add new tests to verify the default behavior (pages-only, no tiles, no manifest). Include both unit tests for defaults and an integration test that verifies actual rendering behavior with defaults.\n\nImplementation Details:\n- Fix `test_code_to_html.py` line 41: Replace `assert \"\u003carticle class='code-article'\u003e\" in html` with `assert \"code-article\" in html` (more robust)\n- Create new file `tests/test_defaults_and_pages_only.py`:\n  - `test_defaults_pages_only()`: Verify RenderConfig defaults (emit=\"pages\", manifest=\"none\", linenos=\"inline\")\n  - `test_render_pages_only_no_tiles()`: Integration test (marked with `@pytest.mark.integration`) that verifies pages are produced and tiles aren't when using defaults","status":"open","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:25.040383-05:00","updated_at":"2025-10-29T20:40:25.040383-05:00","dependencies":[{"issue_id":"nm-7","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:52.107414-05:00","created_by":"daemon"},{"issue_id":"nm-7","depends_on_id":"nm-2","type":"blocks","created_at":"2025-10-29T20:41:01.982204-05:00","created_by":"daemon"}]}
{"id":"nm-8","title":"Update Documentation","description":"Update both README.md and docs/IMPLEMENTATION_PLAN.md to accurately reflect the new pages-only default behavior. Update examples, option descriptions, output structure documentation, and design decision rationale to align with the pages-first philosophy.\n\nImplementation Details:\n- **README.md**:\n  - Update description to emphasize pages-first, tiles optional (line 3)\n  - Update \"Basic Example\" section to show pages-only default (lines 54-60)\n  - Add separate section for tiles showing it as optional (lines 62-78)\n  - Update `--emit` and `--manifest` defaults in options list (lines 95-96)\n  - Update output structure section to show pages-only default (lines 99-114)\n  - Add note about line-number styling\n- **docs/IMPLEMENTATION_PLAN.md**:\n  - Update \"Default Behavior\" section (lines 9-12): pages-only, manifest=none\n  - Update CLI examples to reflect new defaults (lines 63-77, 99-100)\n  - Update \"Design Decisions\" section to explain pages-first rationale (lines 179-183)","status":"open","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:30.248399-05:00","updated_at":"2025-10-29T20:40:30.248399-05:00","dependencies":[{"issue_id":"nm-8","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:52.233401-05:00","created_by":"daemon"},{"issue_id":"nm-8","depends_on_id":"nm-2","type":"blocks","created_at":"2025-10-29T20:41:02.76837-05:00","created_by":"daemon"}]}
{"id":"nm-9","title":"Lower Python Version Requirement to 3.10","description":"Lower the Python version requirement from 3.13 to 3.10 for better compatibility with AI/ML packages commonly used in this project. Most AI packages (sentence-transformers, transformers, chromadb, clip, etc.) support Python 3.10+, and Python 3.10 is mature and widely deployed. The code review confirmed the codebase works fine with Python 3.10.\n\nImplementation Details:\n- Update `pyproject.toml`:\n  - Line 9: `requires-python = \"\u003e=3.10\"` (change from `\u003e=3.13`)\n  - Line 36: `target-version = \"py310\"` (change from `py313`)\n  - Line 59: `python_version = \"3.10\"` (change from `\"3.13\"`)","status":"closed","priority":2,"issue_type":"task","assignee":"ProductThor","created_at":"2025-10-29T20:40:34.337506-05:00","updated_at":"2025-10-29T21:03:43.337221-05:00","closed_at":"2025-10-29T21:03:43.337221-05:00","dependencies":[{"issue_id":"nm-9","depends_on_id":"nm-1","type":"parent-child","created_at":"2025-10-29T20:40:52.359592-05:00","created_by":"daemon"}]}
